import{u as H,r as s,j as t,G as n,T as M,M as j,B as l,S as z,C as G,Z as L}from"./index-3TtWpvP2.js";import{T as A}from"./TextField-yUBhfeYA.js";import{A as E}from"./Alert-o3e75iSj.js";import{B as N}from"./Button-mOA-xCVY.js";import{T as R,d as U,b as P,c as e,a as k}from"./TableRow-MAD580Pe.js";import{f as q,P as O}from"./Pagination-2lYZoYzw.js";function X(){const{api:c,user:r}=H(),[m,p]=s.useState([]),[g,w]=s.useState(!0),[o,f]=s.useState(1),[S]=s.useState(20),[h,B]=s.useState({total:0,total_pages:1}),[d,I]=s.useState(""),[x,y]=s.useState(!1),[u,W]=s.useState(""),[_,b]=s.useState(""),[v,T]=s.useState(""),C=()=>{w(!0);const a={page:o,limit:S};r?.is_admin&&d&&(a.merchant_id=d),c.get("/api/dashboard/withdrawals",{params:a}).then(i=>{p(i.data?.withdrawals||[]);const D=i.data?.pagination||{};B({total:D.total||0,total_pages:D.total_pages||1})}).catch(()=>p([])).finally(()=>w(!1))};s.useEffect(()=>{C()},[c,o,S,d,r?.is_admin]);const F=async a=>{if(a.preventDefault(),!!u.trim()){b(""),T(""),y(!0);try{await c.post("/api/dashboard/withdraw",{destination_address:u.trim()}),T("Withdrawal initiated successfully."),W(""),C()}catch(i){b(i.response?.data?.error||"Withdrawal failed.")}finally{y(!1)}}};return t.jsxs(n,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[t.jsx(n,{size:12,children:t.jsx(M,{variant:"h5",children:"Withdrawals"})}),t.jsx(n,{size:12,children:t.jsx(j,{title:"Withdraw USDT",children:t.jsx(l,{component:"form",onSubmit:F,sx:{maxWidth:480},children:t.jsxs(z,{spacing:2,children:[t.jsx(A,{fullWidth:!0,label:"Destination address (Solana)",value:u,onChange:a=>W(a.target.value),placeholder:"Enter Solana address",required:!0,disabled:x}),_&&t.jsx(E,{severity:"error",children:_}),v&&t.jsx(E,{severity:"success",children:v}),t.jsx(N,{type:"submit",variant:"contained",disabled:x,children:x?"Withdrawing...":"Withdraw"})]})})})}),r?.is_admin&&t.jsx(n,{size:12,children:t.jsx(j,{content:!1,children:t.jsx(l,{sx:{p:2},children:t.jsx(A,{size:"small",label:"Merchant ID",value:d,onChange:a=>{I(a.target.value),f(1)},sx:{minWidth:160}})})})}),t.jsx(n,{size:12,children:t.jsx(j,{title:`Withdrawal history (${h.total} total)`,content:!1,children:g?t.jsx(l,{sx:{p:4,textAlign:"center"},children:t.jsx(G,{})}):t.jsxs(t.Fragment,{children:[t.jsxs(R,{size:"small",sx:{minWidth:640},children:[t.jsx(U,{children:t.jsxs(P,{children:[t.jsx(e,{children:"ID"}),r?.is_admin&&t.jsx(e,{children:"Merchant ID"}),t.jsx(e,{children:"Destination"}),t.jsx(e,{align:"right",children:"Total Withdrawn (USDT)"}),t.jsx(e,{children:"Success / Failed"}),t.jsx(e,{children:"Status"}),t.jsx(e,{children:"Created"})]})}),t.jsx(k,{children:m.map(a=>t.jsxs(P,{hover:!0,children:[t.jsx(e,{children:a.id}),r?.is_admin&&t.jsx(e,{children:a.merchant_id}),t.jsx(e,{sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:a.destination_address}),t.jsx(e,{align:"right",children:Number(a.total_withdrawn||0).toLocaleString()}),t.jsxs(e,{children:[a.successful_withdrawals," / ",a.failed_withdrawals]}),t.jsx(e,{children:t.jsx(L,{label:a.status||"pending",size:"small",color:a.status==="completed"?"success":"default",variant:"outlined"})}),t.jsx(e,{children:a.created_at?q(new Date(a.created_at),"MMM d, yyyy HH:mm"):"â€”"})]},a.id))})]}),m.length===0&&!g&&t.jsx(l,{sx:{p:4,textAlign:"center"},children:t.jsx(M,{color:"text.secondary",children:"No withdrawals yet."})}),h.total_pages>1&&t.jsx(z,{direction:"row",justifyContent:"center",sx:{py:2},children:t.jsx(O,{count:h.total_pages,page:o,onChange:(a,i)=>f(i),color:"primary"})})]})})})]})}export{X as default};
//# sourceMappingURL=index-C0NL-IHY.js.map
