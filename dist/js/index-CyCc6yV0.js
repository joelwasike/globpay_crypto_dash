import{W as ee,X as te,Y as re,u as ae,r as h,j as e,G as S,T as g,M as H,B as z,S as E,C as le,Z as ie,_ as se}from"./index-Dp2XNDKK.js";import{t as oe}from"./transactionShape-GJ30zwZA.js";import{T as O}from"./TextField-DUMBoiOr.js";import{M as w}from"./MenuItem-DeRE2z4K.js";import{B as A}from"./Button-DXd2n7Bs.js";import{A as ce}from"./Alert-DpniVkhg.js";import{T as de,d as ue,b as U,c as x,a as fe}from"./TableRow-qJTSE9r_.js";import{f as V,P as pe}from"./Pagination-CPcFk552.js";import{D as he,a as xe,b as Ce,c as me}from"./DialogActions-BTXklEnG.js";var k={exports:{}},y={},R={},X;function je(){if(X)return R;X=1,Object.defineProperty(R,"__esModule",{value:!0});var s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"};return R.default=s,R}var Y;function ge(){if(Y)return y;Y=1,Object.defineProperty(y,"__esModule",{value:!0}),y.default=void 0;var s=c(ee()),l=o(je()),u=o(te());function o(t){return t&&t.__esModule?t:{default:t}}function f(t){if(typeof WeakMap!="function")return null;var i=new WeakMap,n=new WeakMap;return(f=function(a){return a?n:i})(t)}function c(t,i){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=f(i);if(n&&n.has(t))return n.get(t);var a={__proto__:null},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=v?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(a,d,p):a[d]=t[d]}return a.default=t,n&&n.set(t,a),a}function C(){return C=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},C.apply(this,arguments)}const m=(t,i)=>s.createElement(u.default,C({},t,{ref:i,icon:l.default})),_=s.forwardRef(m);return y.default=_,y}var Z;function ve(){return Z||(Z=1,(function(s,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;const u=o(ge());function o(c){return c&&c.__esModule?c:{default:c}}const f=u;l.default=f,s.exports=f})(k,k.exports)),k.exports}var _e=ve();const Oe=re(_e);var T={exports:{}},b={},q={},J;function ye(){if(J)return q;J=1,Object.defineProperty(q,"__esModule",{value:!0});var s={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"};return q.default=s,q}var K;function be(){if(K)return b;K=1,Object.defineProperty(b,"__esModule",{value:!0}),b.default=void 0;var s=c(ee()),l=o(ye()),u=o(te());function o(t){return t&&t.__esModule?t:{default:t}}function f(t){if(typeof WeakMap!="function")return null;var i=new WeakMap,n=new WeakMap;return(f=function(a){return a?n:i})(t)}function c(t,i){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=f(i);if(n&&n.has(t))return n.get(t);var a={__proto__:null},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in t)if(d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)){var p=v?Object.getOwnPropertyDescriptor(t,d):null;p&&(p.get||p.set)?Object.defineProperty(a,d,p):a[d]=t[d]}return a.default=t,n&&n.set(t,a),a}function C(){return C=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},C.apply(this,arguments)}const m=(t,i)=>s.createElement(u.default,C({},t,{ref:i,icon:l.default})),_=s.forwardRef(m);return b.default=_,b}var Q;function De(){return Q||(Q=1,(function(s,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;const u=o(be());function o(c){return c&&c.__esModule?c:{default:c}}const f=u;l.default=f,s.exports=f})(T,T.exports)),T.exports}var Me=De();const Pe=re(Me);function Se({status:s}){const l=(s||"").toUpperCase();let u="default",o=e.jsx(Oe,{});return l==="SUCCESS"||l==="COMPLETED"||l==="COMPLETE"?(u="success",o=e.jsx(se,{})):l==="PENDING"?u="warning":l==="FAILED"&&(u="error",o=e.jsx(Pe,{})),e.jsx(ie,{icon:o,label:s||"N/A",color:u,size:"small",variant:"outlined"})}function Ae(){const{api:s,user:l}=ae(),[u,o]=h.useState([]),[f,c]=h.useState(!0),[C,m]=h.useState(1),[_]=h.useState(20),[t,i]=h.useState({total:0,total_pages:1}),[n,a]=h.useState("all"),[v,d]=h.useState(""),[p,$]=h.useState(""),[D,L]=h.useState(""),[M,F]=h.useState(""),[B,I]=h.useState(null),[j,W]=h.useState(null),N=h.useCallback(async()=>{try{c(!0),I(null);const r={page:C,limit:_};n!=="all"&&(r.status=n.toLowerCase()),v&&(r.from_date=v),p&&(r.to_date=p),D&&(r.deposit_id=D),l?.is_admin&&M&&(r.merchant_id=M);const P=await s.get("/api/dashboard/transactions",{params:r});o(P.data?.transactions||[]);const G=P.data?.pagination||{};i({total:G.total||0,total_pages:G.total_pages||1})}catch(r){I(r.response?.data?.error||"Failed to load transactions"),o([])}finally{c(!1)}},[s,C,_,n,v,p,D,M,l?.is_admin]);h.useEffect(()=>{N()},[N]);const ne=oe(u);return e.jsxs(S,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(S,{size:12,children:e.jsx(g,{variant:"h5",children:"Transactions"})}),e.jsx(S,{size:12,children:e.jsx(H,{content:!1,children:e.jsx(z,{sx:{p:3},children:e.jsxs(E,{spacing:2,direction:{xs:"column",sm:"row"},flexWrap:"wrap",useFlexGap:!0,children:[e.jsxs(O,{select:!0,size:"small",label:"Status",value:n,onChange:r=>{a(r.target.value),m(1)},sx:{minWidth:140},children:[e.jsx(w,{value:"all",children:"All"}),e.jsx(w,{value:"completed",children:"Completed"}),e.jsx(w,{value:"pending",children:"Pending"}),e.jsx(w,{value:"failed",children:"Failed"})]}),e.jsx(O,{size:"small",type:"date",label:"From",value:v,onChange:r=>{d(r.target.value),m(1)},InputLabelProps:{shrink:!0},sx:{minWidth:160}}),e.jsx(O,{size:"small",type:"date",label:"To",value:p,onChange:r=>{$(r.target.value),m(1)},InputLabelProps:{shrink:!0},sx:{minWidth:160}}),e.jsx(O,{size:"small",label:"Deposit ID",placeholder:"Filter by deposit id",value:D,onChange:r=>{L(r.target.value),m(1)},sx:{minWidth:160}}),l?.is_admin&&e.jsx(O,{size:"small",label:"Merchant ID",placeholder:"Merchant ID",value:M,onChange:r=>{F(r.target.value),m(1)},sx:{minWidth:120}}),e.jsx(A,{variant:"outlined",size:"small",onClick:()=>{a("all"),d(""),$(""),L(""),F(""),m(1)},children:"Clear"})]})})})}),e.jsx(S,{size:12,children:e.jsxs(H,{title:`Transactions (${t.total} total)`,content:!1,children:[B&&e.jsx(ce,{severity:"error",sx:{m:2},onClose:()=>I(null),children:B}),f?e.jsx(z,{sx:{p:4,textAlign:"center"},children:e.jsx(le,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(de,{size:"small",sx:{minWidth:640},children:[e.jsx(ue,{children:e.jsxs(U,{children:[e.jsx(x,{children:"ID"}),e.jsx(x,{children:"Deposit / Merchant Ref"}),l?.is_admin&&e.jsx(x,{children:"Merchant"}),e.jsx(x,{align:"right",children:"Amount (USDT)"}),e.jsx(x,{children:"Status"}),e.jsx(x,{children:"Date"}),e.jsx(x,{align:"center",children:"Actions"})]})}),e.jsx(fe,{children:ne.map(r=>e.jsxs(U,{hover:!0,children:[e.jsx(x,{children:r.id}),e.jsx(x,{children:r.merchant_deposit_id||r.deposit_id||"—"}),l?.is_admin&&e.jsx(x,{children:r.merchant_email||r.merchant_id||"—"}),e.jsx(x,{align:"right",children:Number(r.amount||0).toLocaleString()}),e.jsx(x,{children:e.jsx(Se,{status:r.transaction_status})}),e.jsx(x,{children:r.created_at?V(new Date(r.created_at),"MMM d, yyyy HH:mm"):"—"}),e.jsx(x,{align:"center",children:e.jsx(A,{size:"small",variant:"outlined",onClick:()=>W(r),children:"View"})})]},r.id))})]}),u.length===0&&!f&&e.jsx(z,{sx:{p:4,textAlign:"center"},children:e.jsx(g,{color:"text.secondary",children:"No transactions found."})}),t.total_pages>1&&e.jsx(E,{direction:"row",justifyContent:"center",sx:{py:2},children:e.jsx(pe,{count:t.total_pages,page:C,onChange:(r,P)=>m(P),color:"primary"})})]})]})}),e.jsxs(he,{open:!!j,onClose:()=>W(null),maxWidth:"sm",fullWidth:!0,children:[e.jsx(xe,{children:"Transaction details"}),e.jsx(Ce,{dividers:!0,children:j&&e.jsxs(E,{spacing:1.5,children:[e.jsxs(g,{variant:"body2",children:[e.jsx("strong",{children:"ID:"})," ",j.id]}),e.jsxs(g,{variant:"body2",children:[e.jsx("strong",{children:"Deposit ID:"})," ",j.deposit_id]}),e.jsxs(g,{variant:"body2",children:[e.jsx("strong",{children:"Merchant deposit ID:"})," ",j.merchant_deposit_id||"—"]}),e.jsxs(g,{variant:"body2",children:[e.jsx("strong",{children:"Amount:"})," ",Number(j.amount||0).toLocaleString()," USDT"]}),e.jsxs(g,{variant:"body2",children:[e.jsx("strong",{children:"Status:"})," ",j.status]}),e.jsxs(g,{variant:"body2",children:[e.jsx("strong",{children:"Created:"})," ",j.created_at?V(new Date(j.created_at),"PPpp"):"—"]}),j.tx_id&&e.jsxs(g,{variant:"body2",children:[e.jsx("strong",{children:"Tx ID:"})," ",j.tx_id]})]})}),e.jsx(me,{children:e.jsx(A,{onClick:()=>W(null),children:"Close"})})]})]})}export{Ae as default};
//# sourceMappingURL=index-CyCc6yV0.js.map
