import{W as J,X as Q,Y as ee,u as ae,r as h,j as e,G as b,M as F,T as _,S as w,B as H,C as ne,Z as L}from"./index-3TtWpvP2.js";import{B as A}from"./Button-mOA-xCVY.js";import{A as T}from"./Alert-o3e75iSj.js";import{T as se,d as ie,b as N,c,a as le}from"./TableRow-MAD580Pe.js";import{f as oe,P as ce}from"./Pagination-2lYZoYzw.js";import{D as de,a as ue,b as pe,c as fe}from"./DialogActions-Dv5Ba7iy.js";import{T as $}from"./TextField-yUBhfeYA.js";var P={exports:{}},C={},q={},V;function he(){if(V)return q;V=1,Object.defineProperty(q,"__esModule",{value:!0});var l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M678.3 642.4c24.2-13 51.9-20.4 81.4-20.4h.1c3 0 4.4-3.6 2.2-5.6a371.67 371.67 0 00-103.7-65.8c-.4-.2-.8-.3-1.2-.5C719.2 505 759.6 431.7 759.6 349c0-137-110.8-248-247.5-248S264.7 212 264.7 349c0 82.7 40.4 156 102.6 201.1-.4.2-.8.3-1.2.5-44.7 18.9-84.8 46-119.3 80.6a373.42 373.42 0 00-80.4 119.5A373.6 373.6 0 00137 888.8a8 8 0 008 8.2h59.9c4.3 0 7.9-3.5 8-7.8 2-77.2 32.9-149.5 87.6-204.3C357 628.2 432.2 597 512.2 597c56.7 0 111.1 15.7 158 45.1a8.1 8.1 0 008.1.3zM512.2 521c-45.8 0-88.9-17.9-121.4-50.4A171.2 171.2 0 01340.5 349c0-45.9 17.9-89.1 50.3-121.6S466.3 177 512.2 177s88.9 17.9 121.4 50.4A171.2 171.2 0 01683.9 349c0 45.9-17.9 89.1-50.3 121.6C601.1 503.1 558 521 512.2 521zM880 759h-84v-84c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v84h-84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h84v84c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-84h84c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z"}}]},name:"user-add",theme:"outlined"};return q.default=l,q}var Y;function xe(){if(Y)return C;Y=1,Object.defineProperty(C,"__esModule",{value:!0}),C.default=void 0;var l=o(J()),d=x(he()),m=x(Q());function x(t){return t&&t.__esModule?t:{default:t}}function f(t){if(typeof WeakMap!="function")return null;var s=new WeakMap,n=new WeakMap;return(f=function(a){return a?n:s})(t)}function o(t,s){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=f(s);if(n&&n.has(t))return n.get(t);var a={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var u=j?Object.getOwnPropertyDescriptor(t,i):null;u&&(u.get||u.set)?Object.defineProperty(a,i,u):a[i]=t[i]}return a.default=t,n&&n.set(t,a),a}function v(){return v=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},v.apply(this,arguments)}const g=(t,s)=>l.createElement(m.default,v({},t,{ref:s,icon:d.default})),y=l.forwardRef(g);return C.default=y,C}var G;function ve(){return G||(G=1,(function(l,d){Object.defineProperty(d,"__esModule",{value:!0}),d.default=void 0;const m=x(xe());function x(o){return o&&o.__esModule?o:{default:o}}const f=m;d.default=f,l.exports=f})(P,P.exports)),P.exports}var me=ve();const je=ee(me);var R={exports:{}},M={},D={},K;function ye(){if(K)return D;K=1,Object.defineProperty(D,"__esModule",{value:!0});var l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};return D.default=l,D}var X;function _e(){if(X)return M;X=1,Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var l=o(J()),d=x(ye()),m=x(Q());function x(t){return t&&t.__esModule?t:{default:t}}function f(t){if(typeof WeakMap!="function")return null;var s=new WeakMap,n=new WeakMap;return(f=function(a){return a?n:s})(t)}function o(t,s){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=f(s);if(n&&n.has(t))return n.get(t);var a={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(i!=="default"&&Object.prototype.hasOwnProperty.call(t,i)){var u=j?Object.getOwnPropertyDescriptor(t,i):null;u&&(u.get||u.set)?Object.defineProperty(a,i,u):a[i]=t[i]}return a.default=t,n&&n.set(t,a),a}function v(){return v=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},v.apply(this,arguments)}const g=(t,s)=>l.createElement(m.default,v({},t,{ref:s,icon:d.default})),y=l.forwardRef(g);return M.default=y,M}var Z;function ge(){return Z||(Z=1,(function(l,d){Object.defineProperty(d,"__esModule",{value:!0}),d.default=void 0;const m=x(_e());function x(o){return o&&o.__esModule?o:{default:o}}const f=m;d.default=f,l.exports=f})(R,R.exports)),R.exports}var Oe=ge();const be=ee(Oe);function De(){const{api:l,user:d}=ae(),[m,x]=h.useState([]),[f,o]=h.useState(!0),[v,g]=h.useState(1),[y]=h.useState(20),[t,s]=h.useState({total:0,total_pages:1}),[n,a]=h.useState(!1),[j,i]=h.useState({email:"",password:"",business_name:""}),[u,z]=h.useState(!1),[E,S]=h.useState(""),[O,I]=h.useState(null),[k,W]=h.useState(""),U=h.useCallback(()=>{o(!0),W(""),l.get("/api/admin/merchants",{params:{page:v,limit:y}}).then(r=>{x(r.data?.merchants||[]);const p=r.data?.pagination||{};s({total:p.total||0,total_pages:p.total_pages||1})}).catch(r=>{W(r.response?.data?.error||"Failed to load merchants"),x([])}).finally(()=>o(!1))},[l,v,y]);h.useEffect(()=>{d?.is_admin&&U()},[d?.is_admin,U]);const te=async r=>{r.preventDefault(),S(""),z(!0);try{const p=await l.post("/api/admin/merchants",{email:j.email,password:j.password,business_name:j.business_name});I(p.data?.merchant||p.data),i({email:"",password:"",business_name:""}),U()}catch(p){S(p.response?.data?.error||"Failed to create merchant")}finally{z(!1)}},B=()=>{a(!1),S(""),I(null),i({email:"",password:"",business_name:""})},re=r=>{r&&navigator.clipboard&&navigator.clipboard.writeText(r)};return d?.is_admin?e.jsxs(b,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(b,{size:12,children:e.jsxs(w,{direction:"row",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",children:[e.jsx(_,{variant:"h5",children:"Merchants"}),e.jsx(A,{variant:"contained",startIcon:e.jsx(je,{}),onClick:()=>a(!0),children:"Create merchant"})]})}),e.jsx(b,{size:12,children:e.jsxs(F,{title:`Merchants (${t.total} total)`,content:!1,children:[k&&e.jsx(T,{severity:"error",sx:{m:2},onClose:()=>W(""),children:k}),f?e.jsx(H,{sx:{p:4,textAlign:"center"},children:e.jsx(ne,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(se,{size:"small",sx:{minWidth:640},children:[e.jsx(ie,{children:e.jsxs(N,{children:[e.jsx(c,{children:"ID"}),e.jsx(c,{children:"Email"}),e.jsx(c,{children:"Business name"}),e.jsx(c,{children:"Merchant ID"}),e.jsx(c,{children:"USDT balance"}),e.jsx(c,{children:"Admin"}),e.jsx(c,{children:"Active"}),e.jsx(c,{children:"Created"})]})}),e.jsx(le,{children:m.map(r=>e.jsxs(N,{hover:!0,children:[e.jsx(c,{children:r.id}),e.jsx(c,{children:r.email}),e.jsx(c,{children:r.business_name||"—"}),e.jsx(c,{children:r.merchant_id??"—"}),e.jsx(c,{children:Number(r.usdt_balance||0).toLocaleString()}),e.jsx(c,{children:e.jsx(L,{label:r.is_admin?"Yes":"No",size:"small",color:r.is_admin?"primary":"default",variant:"outlined"})}),e.jsx(c,{children:e.jsx(L,{label:r.is_active?"Yes":"No",size:"small",color:r.is_active?"success":"default",variant:"outlined"})}),e.jsx(c,{children:r.created_at?oe(new Date(r.created_at),"MMM d, yyyy"):"—"})]},r.id))})]}),m.length===0&&!f&&e.jsx(H,{sx:{p:4,textAlign:"center"},children:e.jsx(_,{color:"text.secondary",children:"No merchants yet. Create one to get started."})}),t.total_pages>1&&e.jsx(w,{direction:"row",justifyContent:"center",sx:{py:2},children:e.jsx(ce,{count:t.total_pages,page:v,onChange:(r,p)=>g(p),color:"primary"})})]})]})}),e.jsxs(de,{open:n,onClose:B,maxWidth:"sm",fullWidth:!0,children:[e.jsx(ue,{children:"Create merchant"}),e.jsxs("form",{onSubmit:te,children:[e.jsx(pe,{dividers:!0,children:e.jsxs(w,{spacing:2,children:[E&&e.jsx(T,{severity:"error",children:E}),O&&e.jsxs(T,{severity:"success",children:[e.jsx(_,{variant:"subtitle2",children:"Merchant created."}),e.jsx(_,{variant:"body2",children:"API key (copy and share securely):"}),e.jsxs(w,{direction:"row",alignItems:"center",spacing:1,sx:{mt:1},children:[e.jsx(_,{variant:"body2",sx:{fontFamily:"monospace",wordBreak:"break-all"},children:O.api_key}),e.jsx(A,{size:"small",startIcon:e.jsx(be,{}),onClick:()=>re(O.api_key),children:"Copy"})]})]}),e.jsx($,{fullWidth:!0,label:"Email",type:"email",required:!0,value:j.email,onChange:r=>i(p=>({...p,email:r.target.value})),disabled:u}),e.jsx($,{fullWidth:!0,label:"Password",type:"password",required:!0,inputProps:{minLength:8},helperText:"Min 8 characters",value:j.password,onChange:r=>i(p=>({...p,password:r.target.value})),disabled:u}),e.jsx($,{fullWidth:!0,label:"Business name",required:!0,value:j.business_name,onChange:r=>i(p=>({...p,business_name:r.target.value})),disabled:u})]})}),e.jsxs(fe,{children:[e.jsx(A,{onClick:B,children:O?"Done":"Cancel"}),!O&&e.jsx(A,{type:"submit",variant:"contained",disabled:u,children:u?"Creating...":"Create"})]})]})]})]}):e.jsx(b,{container:!0,children:e.jsx(b,{size:12,children:e.jsx(F,{children:e.jsx(_,{color:"text.secondary",children:"This page is only available to administrators."})})})})}export{De as default};
//# sourceMappingURL=index-v31hpn0V.js.map
