import{u as k,f as I,r as n,j as e,B as g,C as M,G as s,T as v,M as l,S as N}from"./index-3TtWpvP2.js";import{A as c,B as E,L as G}from"./LineChart-BbWfdvZA.js";import{T as j}from"./TextField-yUBhfeYA.js";import{M as f}from"./MenuItem-BqF2Cxui.js";function T(r){return r.toISOString().slice(0,10)}function U(){const{api:r}=k(),y=I(),[w,S]=n.useState(!0),[a,z]=n.useState({completed:0,failed:0,pending:0}),[C,D]=n.useState({periods:[]}),[d,A]=n.useState(()=>T(new Date(Date.now()-720*60*60*1e3))),[u,B]=n.useState(()=>T(new Date)),[x,L]=n.useState("day");if(n.useEffect(()=>{let t=!1;async function p(){try{S(!0);const[h,F]=await Promise.all([r.get("/api/dashboard/analytics/by-status"),r.get("/api/dashboard/analytics/overview",{params:{from_date:d,to_date:u,group_by:x}})]);if(t)return;z(h.data?.by_status||{}),D(F.data?.analytics||{periods:[]})}catch(h){console.error(h)}finally{t||S(!1)}}return p(),()=>{t=!0}},[r,d,u,x]),w)return e.jsx(g,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:e.jsx(M,{})});const m=(a.completed||0)+(a.failed||0)+(a.pending||0),b=m>0?(a.completed/m*100).toFixed(1):0,i=C.periods||[],o=i.map(t=>t.date),P=i.map(t=>Number(t.total_amount||0)),_=i.map(t=>Number(t.transaction_count||0));return e.jsxs(s,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[e.jsx(s,{size:12,children:e.jsx(v,{variant:"h5",children:"Analytics"})}),e.jsx(s,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsx(c,{title:"Total Transactions",count:String(m),extra:String(a.pending)})}),e.jsx(s,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsx(c,{title:"Completed",count:String(a.completed||0),percentage:Number(b),color:"success",extra:`${b}%`})}),e.jsx(s,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsx(c,{title:"Pending",count:String(a.pending||0),isLoss:!0,color:"warning",extra:String(a.failed||0)})}),e.jsx(s,{size:{xs:12,sm:6,md:4,lg:3},children:e.jsx(c,{title:"Total Volume (USDT)",count:`$${i.reduce((t,p)=>t+Number(p.total_amount||0),0).toLocaleString()}`,extra:"Period"})}),e.jsx(s,{size:12,children:e.jsx(l,{title:"Filters",content:!1,children:e.jsxs(N,{direction:"row",spacing:2,sx:{p:2},flexWrap:"wrap",children:[e.jsx(j,{size:"small",type:"date",label:"From",value:d,onChange:t=>A(t.target.value),InputLabelProps:{shrink:!0}}),e.jsx(j,{size:"small",type:"date",label:"To",value:u,onChange:t=>B(t.target.value),InputLabelProps:{shrink:!0}}),e.jsxs(j,{select:!0,size:"small",label:"Group by",value:x,onChange:t=>L(t.target.value),sx:{minWidth:120},children:[e.jsx(f,{value:"day",children:"Day"}),e.jsx(f,{value:"week",children:"Week"}),e.jsx(f,{value:"month",children:"Month"})]})]})})}),o.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(s,{size:12,children:e.jsx(l,{title:"Volume over time (USDT)",content:!1,children:e.jsx(g,{sx:{p:2,height:360},children:e.jsx(E,{xAxis:[{scaleType:"band",data:o}],series:[{data:P,label:"Amount"}],height:320,colors:[y.palette.primary.main]})})})}),e.jsx(s,{size:12,children:e.jsx(l,{title:"Transaction count over time",content:!1,children:e.jsx(g,{sx:{p:2,height:360},children:e.jsx(G,{xAxis:[{scaleType:"point",data:o}],series:[{data:_,label:"Count"}],height:320,colors:[y.palette.info.main]})})})})]}),o.length===0&&e.jsx(s,{size:12,children:e.jsx(l,{children:e.jsx(v,{color:"text.secondary",children:"No data for the selected period."})})})]})}export{U as default};
//# sourceMappingURL=index-Bn1_F6-9.js.map
