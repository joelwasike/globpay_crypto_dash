import{W as J,X as V,Y as Z,u as ne,r as c,j as t,G as p,T as F,M,B as K,S as C,ab as ae,ac as se}from"./index-Dp2XNDKK.js";import{T as x}from"./TextField-DUMBoiOr.js";import{B as W}from"./Button-DXd2n7Bs.js";import{A as z}from"./Alert-DpniVkhg.js";var E={exports:{}},O={},P={},Q;function ie(){if(Q)return P;Q=1,Object.defineProperty(P,"__esModule",{value:!0});var s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"};return P.default=s,P}var G;function le(){if(G)return O;G=1,Object.defineProperty(O,"__esModule",{value:!0}),O.default=void 0;var s=l(J()),o=h(ie()),v=h(V());function h(e){return e&&e.__esModule?e:{default:e}}function f(e){if(typeof WeakMap!="function")return null;var a=new WeakMap,r=new WeakMap;return(f=function(n){return n?r:a})(e)}function l(e,a){if(e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=f(a);if(r&&r.has(e))return r.get(e);var n={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var d=w?Object.getOwnPropertyDescriptor(e,u):null;d&&(d.get||d.set)?Object.defineProperty(n,u,d):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}function y(){return y=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y.apply(this,arguments)}const _=(e,a)=>s.createElement(v.default,y({},e,{ref:a,icon:o.default})),b=s.forwardRef(_);return O.default=b,O}var U;function ue(){return U||(U=1,(function(s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;const v=h(le());function h(l){return l&&l.__esModule?l:{default:l}}const f=v;o.default=f,s.exports=f})(E,E.exports)),E.exports}var oe=ue();const de=Z(oe);var S={exports:{}},m={},I={},X;function ce(){if(X)return I;X=1,Object.defineProperty(I,"__esModule",{value:!0});var s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"};return I.default=s,I}var Y;function fe(){if(Y)return m;Y=1,Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var s=l(J()),o=h(ce()),v=h(V());function h(e){return e&&e.__esModule?e:{default:e}}function f(e){if(typeof WeakMap!="function")return null;var a=new WeakMap,r=new WeakMap;return(f=function(n){return n?r:a})(e)}function l(e,a){if(e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=f(a);if(r&&r.has(e))return r.get(e);var n={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(u!=="default"&&Object.prototype.hasOwnProperty.call(e,u)){var d=w?Object.getOwnPropertyDescriptor(e,u):null;d&&(d.get||d.set)?Object.defineProperty(n,u,d):n[u]=e[u]}return n.default=e,r&&r.set(e,n),n}function y(){return y=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y.apply(this,arguments)}const _=(e,a)=>s.createElement(v.default,y({},e,{ref:a,icon:o.default})),b=s.forwardRef(_);return m.default=b,m}var H;function pe(){return H||(H=1,(function(s,o){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;const v=h(fe());function h(l){return l&&l.__esModule?l:{default:l}}const f=v;o.default=f,s.exports=f})(S,S.exports)),S.exports}var ve=pe();const he=Z(ve);function be(){const{api:s}=ne(),[o,v]=c.useState(null),[h,f]=c.useState(!0),[l,y]=c.useState(!1),[_,b]=c.useState(""),[e,a]=c.useState(""),[r,n]=c.useState(!1),[w,u]=c.useState(""),[d,A]=c.useState(""),[k,$]=c.useState(""),[D,j]=c.useState(""),[B,L]=c.useState(""),[N,T]=c.useState(!1),[q,R]=c.useState("");c.useEffect(()=>{s.get("/api/dashboard/profile").then(i=>{const g=i.data||{};v(g),b(g.business_name||""),a(g.solana_address||"")}).catch(()=>v({})).finally(()=>f(!1))},[s]);const ee=async i=>{i.preventDefault(),y(!0);try{await s.put("/api/dashboard/profile",{business_name:_||void 0,solana_address:e||void 0}),v(g=>({...g,business_name:_,solana_address:e}))}finally{y(!1)}},te=async i=>{if(i.preventDefault(),j(""),L(""),d.length<8){j("New password must be at least 8 characters.");return}if(d!==k){j("New password and confirm do not match.");return}try{await s.put("/api/dashboard/profile/password",{current_password:w,new_password:d}),L("Password updated."),u(""),A(""),$("")}catch(g){j(g.response?.data?.error||"Failed to update password.")}},re=async()=>{R(""),T(!0);try{const i=await s.post("/api/dashboard/profile/regenerate-api-key");R("API key regenerated. Store it securely; it will not be shown again."),v(g=>({...g,api_key:i.data?.api_key||g?.api_key}))}catch(i){R(i.response?.data?.error||"Failed to regenerate API key.")}finally{T(!1)}};return h?t.jsx(p,{container:!0,children:t.jsx(p,{size:12,children:t.jsx(F,{children:"Loading..."})})}):t.jsxs(p,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[t.jsx(p,{size:12,children:t.jsx(F,{variant:"h5",children:"Profile"})}),t.jsx(p,{size:12,children:t.jsx(M,{title:"Profile",children:t.jsx(K,{component:"form",onSubmit:ee,children:t.jsxs(p,{container:!0,spacing:3,children:[t.jsx(p,{size:{xs:12,md:6},children:t.jsx(x,{fullWidth:!0,label:"Email",value:o?.email||"",disabled:!0})}),t.jsx(p,{size:{xs:12,md:6},children:t.jsx(x,{fullWidth:!0,label:"Merchant ID",value:o?.merchant_id??"",disabled:!0})}),t.jsx(p,{size:{xs:12,md:6},children:t.jsx(x,{fullWidth:!0,label:"Business name",value:_,onChange:i=>b(i.target.value)})}),t.jsx(p,{size:{xs:12,md:6},children:t.jsx(x,{fullWidth:!0,label:"Solana address",value:e,onChange:i=>a(i.target.value),placeholder:"Receiving address for USDT"})}),t.jsx(p,{size:12,children:t.jsx(C,{direction:"row",justifyContent:"flex-end",children:t.jsx(W,{type:"submit",variant:"contained",disabled:l,children:l?"Saving...":"Save profile"})})})]})})})}),t.jsx(p,{size:12,children:t.jsx(M,{title:"API key",children:t.jsxs(C,{spacing:2,children:[t.jsx(x,{fullWidth:!0,type:r?"text":"password",label:"API key",value:o?.api_key||"",disabled:!0,InputProps:{endAdornment:t.jsx(ae,{position:"end",children:t.jsx(se,{onClick:()=>n(!r),edge:"end",size:"small",children:r?t.jsx(he,{}):t.jsx(de,{})})})}}),t.jsx(W,{variant:"outlined",color:"warning",onClick:re,disabled:N,children:N?"Regenerating...":"Regenerate API key"}),q&&t.jsx(z,{severity:q.startsWith("API key regenerated")?"success":"error",children:q})]})})}),t.jsx(p,{size:12,children:t.jsx(M,{title:"Change password",children:t.jsx(K,{component:"form",onSubmit:te,children:t.jsxs(C,{spacing:2,sx:{maxWidth:400},children:[t.jsx(x,{fullWidth:!0,type:"password",label:"Current password",value:w,onChange:i=>u(i.target.value),required:!0}),t.jsx(x,{fullWidth:!0,type:"password",label:"New password (min 8 characters)",value:d,onChange:i=>A(i.target.value),required:!0}),t.jsx(x,{fullWidth:!0,type:"password",label:"Confirm new password",value:k,onChange:i=>$(i.target.value),required:!0}),D&&t.jsx(z,{severity:"error",children:D}),B&&t.jsx(z,{severity:"success",children:B}),t.jsx(W,{type:"submit",variant:"contained",children:"Update password"})]})})})})]})}export{be as default};
//# sourceMappingURL=index-BapCLdsn.js.map
